"use strict";var Game=function(){function e(){console.log("Iniciando Aplicaci√≤n"),this.cargando=!0,this.iniciado=!1}return e.prototype.efecto_carga=function(){this.cargando=!1,this.cargando||(document.getElementById("precarga").style.display="none",document.getElementById("contenedor_juego").style.display="block")},e.prototype.endGame=function(){if(juego.iniciado&&(console.log("finalizando juego ..."),"undefined"!=typeof Storage)){document.getElementById("label_pregunta").innerHTML="",document.getElementById("div_impresion_errores").innerHTML="";var e=document.getElementById("sonido_ganador");e.pause(),e.currentTime=0,e.play();var t="",n='<div class="sixteen wide tablet sixteen wide computer column fondo_ganador">',a=JSON.parse(localStorage.getItem("puntajes"));a[0].equipo1>a[0].equipo2&&(n+="<span class='winner'>GANADOR</span><br><br><br><span class='winner'>EQUIPO 1</span>",t=a[0].equipo1),a[0].equipo2>a[0].equipo1&&(n+="<span class='winner'>GANADOR</span><br><br><br><span class='winner'>EQUIPO 2</span>",t=a[0].equipo2),n+="</div>",document.getElementById("tabla_de_respuestas").innerHTML=n,document.getElementById("label_ronda").innerHTML="Resultado "+t+" Pts",localStorage.getItem("puntajes")&&localStorage.removeItem("puntajes")}},e.prototype.startGame=function(){if("undefined"!=typeof Storage){console.log("Iniciando Juego..");var e=[{ronda:1,errores:[],puntaje:[],equipo1:0,equipo2:0}];e[0].errores.push(0),e[0].puntaje.push(0),localStorage.setItem("puntajes",JSON.stringify(e)),setTimeout(this.get_ronda,13e3),document.getElementById("sonido_inicio").play(),this.iniciado=!0;var t='<div class="sixteen wide tablet sixteen wide computer column fondo_bienvenida">';t+="<span class='texto_welcome'>COMECEMOS</span><br><br><br><span class='texto_welcome'>A JUGAR</span>",t+="<br><img class='logo_carga' src='./assets/logos/flip.gif'/>",t+="<br><span class='frase'>Elige Confianza,Elige Imacop</span>",document.getElementById("tabla_de_respuestas").innerHTML=t}},e.prototype.mostrar_errores=function(e){var t=JSON.parse(localStorage.getItem("puntajes"));if(t[0].errores[e]){var n=t[0].errores[e];1==n&&(document.getElementById("div_impresion_errores").innerHTML="<img class='tache_img' src='./assets/tache.jpg' />"),2==n&&(document.getElementById("div_impresion_errores").innerHTML="<img class='tache_img' src='./assets/tache.jpg' /><img class='tache_img' src='./assets/tache.jpg' />"),3==n&&(document.getElementById("div_impresion_errores").innerHTML="<img class='tache_img' src='./assets/tache.jpg' /><img class='tache_img' src='./assets/tache.jpg' /><img class='tache_img' src='./assets/tache.jpg' />")}else t[0].errores[e]=0,localStorage.setItem("puntajes",JSON.stringify(t)),document.getElementById("div_impresion_errores").innerHTML=""},e.prototype.get_ronda=function(){var e=JSON.parse(localStorage.getItem("puntajes")),t=e[0].ronda;console.log("ronda actual= "+e[0].ronda),juego.mostrar_errores(t),document.getElementById("label_ronda").innerHTML=3==t?"Ronda "+t+" ,<small>Puntos al Doble</small>":4==t?"Ronda "+t+" ,<small>Puntos al Triple</small>":"Ronda "+t;var n=document.getElementById("c_tematica").value;fetch("./Encuestas/"+n,{method:"GET"}).then(function(e){if(e.ok)return e.text();throw"Error en la llamada Ajax"}).then(function(e){document.getElementById("tabla_de_respuestas").innerHTML="";var n=JSON.parse(e);console.log("data obj = ",n),console.log("ronda"+t);var a=n[0]["ronda"+t].respuestas.length;document.getElementById("label_pregunta").innerHTML=n[0]["ronda"+t].pregunta;for(var o='<div class="sixteen wide tablet sixteen wide computer column">',r=0;r<a;r++)o+="<div class='respuesta_oculta' id='destapar_"+r+"'><a class='manita' onclick=\"juego.destapar("+r+",'"+n[0]["ronda"+t].respuestas[r].respuesta+"','"+n[0]["ronda"+t].respuestas[r].valor+"')\"><span class='indice'>"+(r+1)+"</span>...............................</a></div>";o+="</div>",document.getElementById("tabla_de_respuestas").innerHTML=o}).catch(function(e){console.log(e)})},e.prototype.ronda_siguiente=function(){if(juego.iniciado){console.log("siguiente ronda ..");var e=JSON.parse(localStorage.getItem("puntajes")),t=e[0].ronda;if(t<5)t++,e[0].ronda=t,localStorage.setItem("puntajes",JSON.stringify(e)),this.get_ronda(),this.crear_puntos_ronda(),document.getElementById("sonido_cambio_ronda").play(),console.log("siguiente ronda"+t),this.mostrar_errores(t)}},e.prototype.ronda_anterior=function(){if(juego.iniciado){console.log("anterior ronda ..");var e=JSON.parse(localStorage.getItem("puntajes")),t=e[0].ronda;t>1&&(t--,e[0].ronda=t,localStorage.setItem("puntajes",JSON.stringify(e)),this.get_ronda(),this.crear_puntos_ronda())}},e.prototype.incrementar_error=function(){if(juego.iniciado){var e=JSON.parse(localStorage.getItem("puntajes")),t=e[0].ronda;juego.show_error_modal(),e[0].errores[t]?e[0].errores[t]<3&&(e[0].errores[t]++,localStorage.setItem("puntajes",JSON.stringify(e)),this.mostrar_errores(t)):(e[0].errores[t]++,localStorage.setItem("puntajes",JSON.stringify(e)),this.mostrar_errores(t)),document.getElementById("sonido_error").play()}},e.prototype.destapar=function(e,t,n){if(juego.iniciado){for(var a=t.length;a<=40;a++)t+=".";t=t.toUpperCase(),document.getElementById("destapar_"+e).innerHTML=t+n,this.suma_de_ronda(n);var o=document.getElementById("sonido_destapar");o.pause(),o.currentTime=0,o.play()}},e.prototype.suma_de_ronda=function(e){if(juego.iniciado){var t=JSON.parse(localStorage.getItem("puntajes")),n=t[0].ronda;console.log("suma ronda",n),e=parseInt(e)||0,t[0].puntaje[n]?(t[0].puntaje[n]+=3==n?2*parseInt(e):4==n?3*parseInt(e):e,localStorage.setItem("puntajes",JSON.stringify(t))):(t[0].puntaje[n]=3==n?2*parseInt(e):4==n?3*parseInt(e):e,localStorage.setItem("puntajes",JSON.stringify(t)));var a=t[0].puntaje[n];document.getElementById("c_pts_ronda").value=a}},e.prototype.crear_puntos_ronda=function(){var e=JSON.parse(localStorage.getItem("puntajes")),t=e[0].ronda;e[0].puntaje[t]||(e[0].puntaje[t]=0);var n=e[0].puntaje[t];document.getElementById("c_pts_ronda").value=n},e.prototype.asignar_puntos=function(e){if(juego.iniciado){var t=JSON.parse(localStorage.getItem("puntajes")),n=t[0].ronda,a=t[0].puntaje[n];t[0]["equipo"+e]+=a,document.getElementById("c_pts_eq"+e).value=t[0]["equipo"+e],document.getElementById("c_pts_ronda").value=0,t[0].puntaje[n]=0,localStorage.setItem("puntajes",JSON.stringify(t))}},e.prototype.mostrar_respuestas=function(){if(juego.iniciado){var e=JSON.parse(localStorage.getItem("puntajes"))[0].ronda,t=document.getElementById("c_tematica").value;fetch("./Encuestas/"+t,{method:"GET"}).then(function(e){if(e.ok)return e.text();throw"Error en la llamada Ajax"}).then(function(t){document.getElementById("tabla_de_respuestas").innerHTML="";var n=JSON.parse(t);console.log("data obj = ",n),console.log("ronda"+e);var a=n[0]["ronda"+e].respuestas.length;document.getElementById("label_pregunta").innerHTML=n[0]["ronda"+e].pregunta;for(var o='<div class="sixteen wide tablet sixteen wide computer column">',r=0;r<a;r++){for(var s=n[0]["ronda"+e].respuestas[r].respuesta,i=s.length;i<=40;i++)s+=".";s=s.toUpperCase(),s+=n[0]["ronda"+e].respuestas[r].valor,n[0]["ronda"+e].respuestas[r].valor,o+="<div class='respuesta_oculta' id='destapar_"+r+"'>"+s+"</div>";var d=document.getElementById("sonido_destapar");d.currentTime=0,d.play()}o+="</div>",document.getElementById("tabla_de_respuestas").innerHTML=o}).catch(function(e){console.log(e)})}},e.prototype.startTime=function(){var e=0,t=setInterval(function(){e<5?(e++,console.log(e)):(console.log("tf=",e),juego.incrementar_error(),clearInterval(t))},1e3)},e.prototype.establecer_tematica=function(e){document.getElementById("c_tematica").value=e,document.getElementById("b_play").style.display="block",document.getElementById("c_pts_eq1").value="0",document.getElementById("c_pts_eq2").value="0",document.getElementById("c_pts_ronda").value="0",document.getElementById("label_ronda").innerHTML=""},e.prototype.show_error_modal=function(){document.getElementById("myModal").style.display="block",setTimeout(juego.ocultar_error_grande,1e3)},e.prototype.ocultar_error_grande=function(){document.getElementById("myModal").style.display="none"},e}(),juego=new Game;setTimeout(juego.efecto_carga,1e3),document.getElementById("b_play").addEventListener("click",function(){juego.startGame()}),document.getElementById("b_nextRond").addEventListener("click",function(){juego.ronda_siguiente()}),document.getElementById("b_backtRond").addEventListener("click",function(){juego.ronda_anterior()}),document.getElementById("b_equipo1").addEventListener("click",function(){juego.asignar_puntos(1)}),document.getElementById("b_equipo2").addEventListener("click",function(){juego.asignar_puntos(2)}),document.getElementById("b_error").addEventListener("click",function(){juego.incrementar_error()}),document.getElementById("b_show").addEventListener("click",function(){juego.mostrar_respuestas()}),document.getElementById("b_endPlay").addEventListener("click",function(){juego.endGame()}),juego.show_error_modal();
